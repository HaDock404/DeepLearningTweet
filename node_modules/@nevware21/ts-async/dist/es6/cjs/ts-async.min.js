/*!
 * NevWare21 - ts-async, 0.4.0
 * https://github.com/nevware21/ts-async
 * Copyright (c) NevWare21 and contributors. All rights reserved.
 * Licensed under the MIT license.
 */
"use strict";const a=void 0,s=null,D="",q="function",$="object",u="prototype",F="__proto__",t="undefined",H="Symbol",J="length",L="name";var e="slice";const r=Object,U=r[u];var W=String,n=Array,o=n[u];function B(t){return function(e){return typeof e===t}}function G(e){return U.toString.call(e)}function S(e){return typeof e===t||e===t}const j=B(q);function K(e){var t;return(e||(t=e)!==s&&!S(t))&&e&&typeof e===$}const M=n.isArray,Q=B("number"),V=function(e){return!(!e||"[object Error]"!==G(e))};function R(e){return e&&j(e.then)}const X=r.getOwnPropertyDescriptor,Y=r.hasOwn||function(e,t){return n=t,(r=e)&&U.hasOwnProperty.call(r,n)||!!X(e,t);var r,n};function c(e,t,r){if(e&&K(e))for(const n in e)if(Y(e,n)&&-1===t.call(r||e,n,e[n]))break}function Z(e){throw new TypeError(e)}const ee=r.freeze;function te(e){return ee&&c(e,(e,t)=>{(M(t)||K(t))&&ee(t)}),re(e)}const re=ee||(e=>e),ne=r.getPrototypeOf||(e=>e[F]||s),oe=function(){{var e=te;let r={};return c({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12},(e,t)=>{r[e]=e,r[t]=e}),e(r)}}(),ce=W,ie="__tsUtils$gblCfg";let le;function ue(){var e;return(e=(e=(e=typeof globalThis!==t?globalThis:void 0)||typeof self===t?e:self)||typeof window===t?e:window)||typeof global===t?e:global}function I(e,t){let r=D;if(V(e))r="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'";else try{r=JSON.stringify(e,s,t?Q(t)?t:4:a)}catch(e){r=" - "+I(e,t)}return G(e)+": "+r}const ae=o[e];var se,fe,n=(r,e)=>{let n=e&&e[r];return function(e){var t=e&&e[r]||n;if(t)return t.apply(e,ae.call(arguments,1));t=r,e=e,Z("'"+ce(t)+"' not defined for "+I(e))}};let ve={};const i={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"},A=r.defineProperty;function pe(e,t,r){A(e,t,function(t){let r={};var e;return r[i.c]=!0,r[i.e]=!0,t.l&&(r.get=()=>t.l.v,e=X(t.l,"v"))&&e.set&&(r.set=e=>{t.l.v=e}),c(t,(e,t)=>{r[i[e]]=S(t)?r[i[e]]:t}),r}(r))}let E,de=function(){var e;E=(le||(e=ue()||{},le=e[ie]=e[ie]||{}),le),de=s};function ye(t){let r={};return de&&de(),r.b=E.lzy,A(r,"v",{configurable:!0,get:function(){var e=t();return E.lzy||(A(r,"v",{value:e}),r.b&&delete r.b),E.lzy&&r.b!==E.lzy&&(r.b=E.lzy),e}}),r}function T(r,n){return ye(()=>{{var t=r;let e=n;try{e=t()}catch(e){}return e}})}let l,f,me,he;const k=e=>T(()=>be(e)||a,a),ge=e=>(l=!l||!1===e||E&&E.lzy&&!l.b?T(ue,s):l).v,be=(e,t)=>{t=l&&!1!==t?l.v:ge(t);return t&&t[e]?t[e]:"window"===e&&f?f.v:s},Pe=()=>(me=!me||E&&E.lzy&&!me.b?k("document"):me).v,we=()=>(f=!f||E&&E.lzy&&!f.b?k("window"):f).v,xe=()=>(he=he||T(()=>!(!process||!(process.versions||{}).node),!1)).v;let z,Se,je;function Re(e){return T(function(){return z.v?z.v[e]:a},a)}function Ie(){var e=!z||E&&E.lzy&&!z.b;return e&&(z=k(H)),Se&&!e||(Se=Re("for")),je&&!e||(je=Re("keyFor")),z.v}se="apply";const v=function(e){return e[se].apply(e,ae.call(arguments,1))};function Ae(t,r,n){if(t){var o=t[J]>>>0;for(let e=0;e<o&&!(e in t&&-1===r.call(n||t,t[e],e,t));e++);}}const Ee=n("indexOf",o),O=(n("lastIndexOf",o),n(e,o)),Te=r.create||function(e){if(!e)return{};var t=typeof e;if(t!==$&&t!=q)throw new TypeError("Prototype must be an Object or function: "+I(e));function r(){}return r[u]=e,new r};let ke;function ze(e,t){return(r.setPrototypeOf||function(r,e){(ke=ke||ye(()=>({[F]:[]})instanceof Array)).v?r[F]=e:c(e,(e,t)=>r[e]=t)})(e,t)}const Oe=(e,t)=>{try{t&&(e[L]=t)}catch(e){}},Ce=(e,t)=>{try{pe(e,L,{v:t,c:!0,e:!1})}catch(e){}};function m(){return(Date.now||_e)()}function _e(){return(new Date).getTime()}function h(e){return e[fe]}fe=J;let Ne;function De(){var e=(Ne=!Ne||!Ne.b&&E&&E.lzy?k("performance"):Ne).v;return e&&e.now?e.now():m()}const qe="unref",$e="hasRef",Fe="enabled";function He(e,t,r){let n=!0,o=e?t(s):s,c;const i=()=>(n=!1,o&&o[qe]&&o[qe](),c),l=()=>(o=t(o),n||i(),c),u=()=>{o&&r(o),o=s};return c={cancel:u,refresh:l,hasRef:()=>o&&o[$e]?o[$e]():n,ref:()=>(n=!0,o&&o.ref&&o.ref(),c),unref:i,enabled:!1},A(c,Fe,{get:()=>!!o,set:e=>{!e&&o&&u(),e&&!o&&l()}}),{h:c,dn:()=>{o=s}}}function C(){{var o=this,c=a,i=O(arguments),l=M(c),u=l?c.length:0;let t=(0<u?c[0]:l?a:c)||setTimeout,r=(1<u?c[1]:a)||clearTimeout,e=i[0],n=(i[0]=function(){n.dn(),v(e,o,O(arguments))},He(!0,e=>{if(e){if(e.refresh)return e.refresh(),e;v(r,o,[e])}return v(t,o,i)},function(e){v(r,o,[e])}));return n.h}}let Je,Le=100,Ue=50;function We(e,t){return Be(e,e=>t?t({value:e,rejected:!1}):e,e=>t?t({rejected:!0,reason:e}):e)}function Be(e,t,r,n){let o=e;return R(e)?(t||r)&&(o=e.then(t,r)):t&&(o=t(e)),n&&Ge(o,n),o}function Ge(e,t){let r=e;return t&&(R(e)?r=e.finally?e.finally(t):e.then(function(e){return t(),e},function(e){throw t(),e}):t()),r}let Ke,Me,Qe,Ve=!1;const Xe=["pending","resolving","resolved","rejected"],Ye="dispatchEvent";let Ze;const et="Promise",tt="unhandledRejection",rt=tt.toLowerCase();let _=[],nt=0,ot=10,ct;function it(e){return j(e)?e.toString():I(e)}function lt(e,t,r){let n=O(arguments,3),i=0,l=!1,u,a=[],s=nt++,o=0<_.length?_[_.length-1]:void 0,f=!1,v=null,c;ct=ct||k(et+"RejectionEvent");const p=(o,c)=>{try{return _.push(s),f=!0,v&&v.cancel(),v=null,e(function(r,n){a.push(function(){try{var e=2===i?o:c,t=S(e)?u:j(e)?e(u):e;R(t)?t.then(r,n):(e||3!==i?r:n)(t)}catch(e){n(e)}}),l&&b()},n)}finally{_.pop()}};var d,y,m,h;const g=()=>Xe[i],b=()=>{var e;0<a.length&&(e=a.slice(),a=[],f=!0,t(e),v&&v.cancel(),v=null)},P=(t,r)=>e=>{i===r&&(2===t&&R(e)?(i=1,e.then(P(2,1),P(3,1))):(i=t,l=!0,u=e,b(),f||3!==t||(v=v||C(w,ot))))},w=()=>{if(!f)if(xe())process.emit(tt,u,c);else{var e=we()||ge(),r=rt,n=!!ct.v;let t=Pe();n=(Ze=Ze||T(()=>{var e;return!!(e=t&&t.createEvent?t.createEvent("Event"):void 0)&&e.initEvent},null)).v?t.createEvent("Event"):n?new Event(r):{};pe(o=n,"promise",{g:()=>c}),o.reason=u,Ze.v&&n.initEvent(r,!1,!0),n&&e[Ye]?e[Ye](n):(o=e["on"+r])?o(n):(e=be("console"))&&(e.error||e.log)(r,I(n))}var o};c={then:p,catch:e=>p(void 0,e),finally:t=>{let e=t,r=t;return j(t)&&(e=function(e){return t&&t(),e},r=function(e){throw t&&t(),e}),p(e,r)}},A(c,"state",{get:g}),Ve&&(x=c,y=g,h=()=>G(u),d=()=>f,Ke=Ke||{toString:()=>"[[PromiseState]]"},Me=Me||{toString:()=>"[[PromiseResult]]"},Qe=Qe||{toString:()=>"[[PromiseIsHandled]]"},A(x,Ke,{get:y}),A(x,Me,{get:h}),A(x,Qe,{get:d})),Ie()&&(c[y=oe[11],z&&(!E.lzy||z.b)||Ie(),z.v?z.v[y||11]:(h=oe[11])?ve[h]=ve[h]||(m=H+"."+h,{description:ce(m),toString:()=>H+"("+m+")",_polyfill:!0}):void 0]="IPromise"),c.toString=()=>"IPromise"+(Ve?"["+s+(S(o)?"":":"+o)+"]":"")+" "+g()+(l?" - "+it(u):""),j(r)||Z(et+": executor is not a function - "+it(r));var x=P(3,0);try{r.call(c,P(2,0),x)}catch(e){x(e)}return c}function p(r){return function(e){var t=O(arguments,1);return r((o,c)=>{try{let r=[],n=1;Ae(e,(e,t)=>{e&&(n++,Be(e,e=>{r[t]=e,0==--n&&o(r)},c))}),0==--n&&o(r)}catch(e){c(e)}},t)}}function d(r){return function(t){var e=O(arguments,1);return R(t)?t:r(e=>{e(t)},e)}}function y(t){return function(r){var e=O(arguments,1);return t((e,t)=>{t(r)},e)}}const ut=e=>{Ae(e,e=>{try{e()}catch(e){}})};function g(e,t){return lt(g,function(e){let t=Q(e)?e:0;return e=>{C(()=>{ut(e)},t)}}(t),e,t)}W=p(g),n=d(g),e=y(g);let at;function b(e,t){var r=(at=at||k(et)).v;if(!r)return g(e);j(e)||Z(et+": executor is not a function - "+I(e));let n=0;r=new r((t,r)=>{e(function(e){n=2,t(e)},function(e){n=3,r(e)})});return A(r,"state",{get:function(){return Xe[n]}}),r}var o=p(b),st=d(b),ft=y(b);function P(e){return lt(P,ut,e)}var vt=p(P),pt=d(P),dt=y(P);let yt;function w(e,t){var r=S(t)?yt:t;return lt(w,function(){let c;return 0<=r&&(c={timeout:+r}),t=>{var r=e=>{ut(t)},n=c;function o(e){let t=De();return{didTimeout:e,timeRemaining:()=>{return Ue-(e=t,De()-e);var e}}}if((Je=Je||T(()=>{return!!(e=requestIdleCallback)||e!==a;var e},!1)).v&&requestIdleCallback){let t=He(!0,e=>(e&&cancelIdleCallback(e),requestIdleCallback(e=>{t.dn(),r(e||o(!1))},n)),e=>{cancelIdleCallback(e)});void t.h}else{var e=(n||{}).timeout;C(()=>{r(o(!0))},S(e)?Le:e)}}}(),e,r)}var mt=p(w),ht=d(w),gt=y(w);let bt;function x(e,t){return(bt=bt||ye(()=>b)).v.call(this,e,t)}var Pt=p(x),wt=d(x),xt=y(x);const N="reject",St="Rejected";let jt=0,Rt,It,At={};const Et=()=>{};var Tt=(e,t,r)=>{At[e]||(At[e]=function(n){let o=Error,c=o[u][L],i=Error.captureStackTrace;return t=n,r=function(){var e=this;try{Oe(o,n);var t,r=v(o,e,O(arguments))||e;return r!==e&&(t=ne(e))!==ne(r)&&ze(r,t),i&&i(r,e.constructor),r}finally{Oe(o,c)}},l=o,Ce(r,t),(r=ze(r,l))[u]=l===s?Te(l):(e[u]=l[u],new e),r;function e(){this.constructor=r,Ce(this,t)}var t,r,l}(e));var n=m();return new At[e](`Task [${t.id}] ${r||""}- ${t.st?"Running":"Waiting"}: `+(n-(t.st||t.cr)||"0")+" ms")};function kt(e,t){let r=m()-t;Ae(e,e=>{(e&&!e.rj&&e.st&&e.st<r||!e.st&&e.cr&&e.cr<r)&&e&&e[N](e.rj||Tt("Aborted",e,"Stale "))})}function zt(e,t){t=Ee(e,t);-1!==t&&e.splice(t,1)}exports.createAllPromise=Pt,exports.createAsyncAllPromise=W,exports.createAsyncPromise=g,exports.createAsyncRejectedPromise=e,exports.createAsyncResolvedPromise=n,exports.createIdleAllPromise=mt,exports.createIdlePromise=w,exports.createIdleRejectedPromise=gt,exports.createIdleResolvedPromise=ht,exports.createNativeAllPromise=o,exports.createNativePromise=b,exports.createNativeRejectedPromise=ft,exports.createNativeResolvedPromise=st,exports.createPromise=x,exports.createRejectedPromise=xt,exports.createResolvedPromise=wt,exports.createSyncAllPromise=vt,exports.createSyncPromise=P,exports.createSyncRejectedPromise=dt,exports.createSyncResolvedPromise=pt,exports.createTaskScheduler=function(u,e){let a,t=[],s=[],r,n,f=0,v=(e?e+".":"")+jt++,o;u=u||x;const p=()=>{var e=0<h(t)+h(s);0<r&&(o||(o=C(()=>{kt(t,r),kt(s,r),o&&(o.enabled=0<h(t)+h(s))},n)).unref(),o)&&(o.enabled=e)},d=(c,i)=>(c.st=m(),t.push(c),p(),(t,r)=>{const n=e=>{c.rj=c.rj||e||Tt(St,c),c[N]=Et,l(c),t=null,r&&r(e),r=null};var e=c.id;if(c.rj)n(c.rj);else{c[N]=n;try{var o=i(e);c.to&&R(o)&&(c.t=C(()=>{n(Tt("Timeout",c))},c.to)),Be(o,e=>{l(c),r=null,t&&t(e),t=null},n)}catch(e){n(e)}}}),l=e=>{zt(t,e),e.t&&e.t.cancel(),e.t=null,a&&a===e&&(a=null,h(t)+h(s)===0)&&(o&&o.cancel(),o=null)};var c,i,y,e={idle:!0,queue:(e,t,r)=>{let n=v+"."+f++,o=(t&&(n+="-("+t+")"),{id:n,cr:m(),to:r,[N]:e=>{o.rj=e||Tt(St,o),o[N]=Et}});var c,i,l;return a?o.p=(c=o,i=a,l=e,s.push(c),p(),u((e,t)=>{c.id,i.id,We(i.p,()=>{zt(s,c),d(c,l)(e,t)})})):o.p=u(d(o,e)),(a=o).p},setStaleTimeout:(e,t)=>{o&&o.cancel(),o=null,r=e,n=t||e/10,p()}};return pe(e,"idle",{g:()=>h(t)+h(s)===0}),c=e,i=()=>v,y=()=>({l:a,r:t,w:s}),Rt=Rt||{toString:()=>"[[SchedulerName]]"},It=It||{toString:()=>"[[SchedulerState]]"},A(c,Rt,{get:i}),A(c,It,{get:y}),e},exports.doAwait=Be,exports.doAwaitResponse=We,exports.doFinally=Ge,exports.setCreatePromiseImpl=function(e){bt=e?ye(()=>e):null},exports.setDetaultIdleTimeout=function(e){yt=e},exports.setPromiseDebugState=function(e,t){Ve=e};
//# sourceMappingURL=ts-async.min.js.map

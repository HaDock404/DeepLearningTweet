/*!
 * NevWare21 - ts-async, 0.4.0
 * https://github.com/nevware21/ts-async
 * Copyright (c) NevWare21 and contributors. All rights reserved.
 * Licensed under the MIT license.
 */
System.register("nevware21.ts-async",[],function(wt){"use strict";return{execute:function(){wt({createAsyncPromise:g,createIdlePromise:P,createNativePromise:p,createPromise:w,createSyncPromise:b,createTaskScheduler:function(a,n){function f(){var n=0<h(u)+h(v);0<e&&(r||(r=_(function(){bt(u,e),bt(v,e),r&&(r.enabled=0<h(u)+h(v))},o)).unref(),r)&&(r.enabled=n)}function l(o,c){return o.st=m(),u.push(o),f(),function(t,e){function r(n){o.rj=o.rj||n||pt(yt,o),o[x]=gt,i(o),t=null,e&&e(n),e=null}var n=o.id;if(o.rj)r(o.rj);else{o[x]=r;try{var u=c(n);o.to&&R(u)&&(o.t=_(function(){r(pt("Timeout",o))},o.to)),Mn(u,function(n){i(o),e=null,t&&t(n),t=null},r)}catch(n){r(n)}}}}function i(n){Pt(u,n),n.t&&n.t.cancel(),n.t=null,s&&s===n&&(s=null,h(u)+h(v)===0)&&(r&&r.cancel(),r=null)}var s,e,r,t,u=[],v=[],o=(e=6e5)/10,d=0,y=(n?n+".":"")+mt++,n=(a=a||w,{idle:!0,queue:function(n,t,e){var r,u,o,c=y+"."+d++,i=(t&&(c+="-("+t+")"),(t={id:c,cr:m(),to:e})[x]=function(n){i.rj=n||pt(yt,i),i[x]=gt},t);return i.p=s?(u=s,o=n,v.push(r=i),f(),a(function(n,t){r.id,u.id,Kn(u.p,function(){Pt(v,r),l(r,o)(n,t)})})):a(l(i,n)),(s=i).p},setStaleTimeout:function(n,t){r&&r.cancel(),r=null,e=n,o=t||n/10,f()}});return mn(n,"idle",{g:function(){return h(u)+h(v)===0}}),dt=dt||{toString:function(){return"[[SchedulerState]]"}},E(t=n,vt=vt||{toString:function(){return"[[SchedulerName]]"}},{get:function(){return y}}),E(t,dt,{get:function(){return{l:s,r:u,w:v}}}),n},doAwait:Mn,doAwaitResponse:Kn,doFinally:Qn,setCreatePromiseImpl:function(n){lt=n?u(function(){return n}):null},setDetaultIdleTimeout:function(n){ft=n},setPromiseDebugState:function(n,t){Yn=n}});var f=void 0,s=null,D="",q="function",F="object",v="prototype",H="__proto__",t="undefined",J="Symbol",L="length",U="name",W="slice",e=Object,$=e[v],B=String,G=Array,n=G[v];function K(t){return function(n){return typeof n===t}}function M(n){return $.toString.call(n)}function S(n){return typeof n===t||n===t}var j=K(q);function Q(n){return(n||n!==s&&!S(n))&&n&&typeof n===F}var V=G.isArray,X=K("number"),Y=function(n){return!(!n||"[object Error]"!==M(n))};function R(n){return n&&j(n.then)}var Z=e.getOwnPropertyDescriptor,nn=e.hasOwn||function(n,t){return n&&$.hasOwnProperty.call(n,t)||!!Z(n,t)};function o(n,t,e){if(n&&Q(n))for(var r in n)if(nn(n,r)&&-1===t.call(e||n,r,n[r]))break}function tn(n){throw new TypeError(n)}var en=e.freeze,G=en||function(n){return n},rn=e.getPrototypeOf||function(n){return n[H]||s},un={};o({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12},function(n,t){un[n]=n,un[t]=n});cn=un,en&&o(cn,function(n,t){(V(t)||Q(t))&&en(t)});var on,cn,an=G(cn),fn=B,ln="__tsUtils$gblCfg";function sn(){var n;return(n=(n=(n=typeof globalThis!==t?globalThis:n)||typeof self===t?n:self)||typeof window===t?n:window)||typeof global===t?n:global}function I(n,t){var e=D;if(Y(n))e="{ stack: '"+n.stack+"', message: '"+n.message+"', name: '"+n.name+"'";else try{e=JSON.stringify(n,s,t?X(t)?t:4:f)}catch(n){e=" - "+I(n,t)}return M(n)+": "+e}function vn(e,n){var r=n&&n[e];return function(n){var t=n&&n[e]||r;if(t)return t.apply(n,dn.call(arguments,1));t=n,tn("'"+fn(e)+"' not defined for "+I(t))}}var A,dn=n[W],yn={},c={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"},E=e.defineProperty;function mn(n,t,e){var r,u;E(n,t,(r=e,(u={})[c.c]=!0,u[c.e]=!0,r.l&&(u.get=function(){return r.l.v},n=Z(r.l,"v"))&&n.set&&(u.set=function(n){r.l.v=n}),o(r,function(n,t){u[c[n]]=S(t)?u[c[n]]:t}),u))}var hn=function(){var n;on||(n=sn()||{},on=n[ln]=n[ln]||{}),A=on,hn=s};function u(t){var e={};return hn&&hn(),e.b=A.lzy,E(e,"v",{configurable:!0,get:function(){var n=t();return A.lzy||(E(e,"v",{value:n}),e.b&&delete e.b),A.lzy&&e.b!==A.lzy&&(e.b=A.lzy),n}}),e}function T(e,r){return u(function(){var n=e,t=r;try{t=n()}catch(n){}return t})}var r,i,k,gn,z,pn,bn,O=function(n){return T(function(){return wn(n)||f},f)},Pn=function(n){return(r=!r||!1===n||A&&A.lzy&&!r.b?T(sn,s):r).v},wn=function(n,t){t=r&&!1!==t?r.v:Pn(t);return t&&t[n]?t[n]:"window"===n&&i?i.v:s},Sn=function(){return(i=!i||A&&A.lzy&&!i.b?O("window"):i).v},jn=function(){return(gn=gn||T(function(){return!(!process||!(process.versions||{}).node)},!1)).v};function Rn(n){return T(function(){return z.v?z.v[n]:f},f)}function In(){var n=!z||A&&A.lzy&&!z.b;return n&&(z=O(J)),pn&&!n||(pn=Rn("for")),bn&&!n||(bn=Rn("keyFor")),z.v}var An="apply",d=function(n){return n[An].apply(n,dn.call(arguments,1))};function En(n,t,e){if(n)for(var r=n[L]>>>0,u=0;u<r&&!(u in n&&-1===t.call(e||n,n[u],u,n));u++);}var Tn,kn=vn("indexOf",n),C=(vn("lastIndexOf",n),vn(W,n)),zn=e.create||function(n){if(!n)return{};var t=typeof n;if(t!==F&&t!=q)throw new TypeError("Prototype must be an Object or function: "+I(n));function e(){}return e[v]=n,new e};function On(n,t){return(e.setPrototypeOf||function(e,n){(Tn=Tn||u(function(){var n={};return n[H]=[],n instanceof Array})).v?e[H]=n:o(n,function(n,t){return e[n]=t})})(n,t)}function Cn(n,t){try{mn(n,U,{v:t,c:!0,e:!1})}catch(n){}}function _n(n,t){try{t&&(n[U]=t)}catch(n){}}function m(){return(Date.now||function(){return(new Date).getTime()})()}var Nn,xn=L,h=function(n){return n[xn]};function Dn(){var n=(Nn=!Nn||!Nn.b&&A&&A.lzy?O("performance"):Nn).v;return n&&n.now?n.now():m()}var qn,Fn="unref",Hn="hasRef",Jn="enabled";function Ln(n,t,e){function r(){return i=!1,a&&a[Fn]&&a[Fn](),c}function u(){return a=t(a),i||r(),c}function o(){a&&e(a),a=s}var c,i=!0,a=n?t(s):s,n={cancel:o,refresh:u,hasRef:function(){return a&&a[Hn]?a[Hn]():i},ref:function(){return i=!0,a&&a.ref&&a.ref(),c}};return n[Fn]=r,n[Jn]=!1,E(c=n,Jn,{get:function(){return!!a},set:function(n){!n&&a&&o(),n&&!a&&u()}}),{h:c,dn:function(){a=s}}}function _(){return t=this,n=f,e=C(arguments),u=(r=V(n))?n.length:0,o=(0<u?n[0]:r?f:n)||setTimeout,c=(1<u?n[1]:f)||clearTimeout,i=e[0],e[0]=function(){a.dn(),d(i,t,C(arguments))},(a=Ln(!0,function(n){if(n){if(n.refresh)return n.refresh(),n;d(c,t,[n])}return d(o,t,e)},function(n){d(c,t,[n])})).h;var t,n,e,r,u,o,c,i,a}var Un,Wn,$n,Bn=100,Gn=50;function Kn(n,t){return Mn(n,function(n){return t?t({value:n,rejected:!1}):n},function(n){return t?t({rejected:!0,reason:n}):n})}function Mn(n,t,e,r){var u=n;return R(n)?(t||e)&&(u=n.then(t,e)):t&&(u=t(n)),r&&Qn(u,r),u}function Qn(n,t){var e=n;return t&&(R(n)?e=n.finally?n.finally(t):n.then(function(n){return t(),n},function(n){throw t(),n}):t()),e}var Vn,Xn,Yn=!1,Zn=["pending","resolving","resolved","rejected"],nt="dispatchEvent",tt="Promise",et="unhandledRejection",rt=et.toLowerCase(),N=[],ut=0,ot=10;function ct(n){return j(n)?n.toString():I(n)}function it(n,t,e){function r(u,o){try{return N.push(h),p=!0,b&&b.cancel(),b=null,n(function(e,r){m.push(function(){try{var n=2===d?u:o,t=S(n)?a:j(n)?n(a):n;R(t)?t.then(e,r):(n||3!==d?e:r)(t)}catch(n){r(n)}}),y&&c()},v)}finally{N.pop()}}function u(){return Zn[d]}function c(){var n;0<m.length&&(n=m.slice(),m=[],p=!0,t(n),b&&b.cancel(),b=null)}function o(t,e){return function(n){d===e&&(2===t&&R(n)?(d=1,n.then(o(2,1),o(3,1))):(d=t,y=!0,a=n,c(),p||3!==t||(b=b||_(i,ot))))}}function i(){var n,t,e,r,u;p||(jn()?process.emit(et,a,P):(e=Sn()||Pn(),n=rt,u=function(n){return mn(n,"promise",{g:function(){return P}}),n.reason=a,n},t=!!Xn.v,r=(k=!k||A&&A.lzy&&!k.b?O("document"):k).v,u(u=(Vn=Vn||T(function(){var n;return!!(n=r&&r.createEvent?r.createEvent("Event"):n)&&n.initEvent},null)).v?r.createEvent("Event"):t?new Event(n):{}),Vn.v&&u.initEvent(n,!1,!0),u&&e[nt]?e[nt](u):(t=e["on"+n])?t(u):(e=wn("console"))&&(e.error||e.log)(n,I(u))))}var a,f,l,s,v=C(arguments,3),d=0,y=!1,m=[],h=ut++,g=0<N.length?N[N.length-1]:void 0,p=!1,b=null,P=(Xn=Xn||O(tt+"RejectionEvent"),{then:r,catch:function(n){return r(void 0,n)},finally:function(t){var n=t,e=t;return j(t)&&(n=function(n){return t&&t(),n},e=function(n){throw t&&t(),n}),r(n,e)}}),w=(E(P,"state",{get:u}),Yn&&(f=function(){return M(a)},w=function(){return p},Wn=Wn||{toString:function(){return"[[PromiseResult]]"}},$n=$n||{toString:function(){return"[[PromiseIsHandled]]"}},E(s=P,Un=Un||{toString:function(){return"[[PromiseState]]"}},{get:u}),E(s,Wn,{get:f}),E(s,$n,{get:w})),In()&&(P[f=an[11],z&&(!A.lzy||z.b)||In(),z.v?z.v[f||11]:(s=an[11])?yn[s]=yn[s]||{description:fn(l=J+"."+s),toString:function(){return J+"("+l+")"},_polyfill:!0}:void 0]="IPromise"),P.toString=function(){return"IPromise"+(Yn?"["+h+(S(g)?"":":"+g)+"]":"")+" "+u()+(y?" - "+ct(a):"")},j(e)||tn(tt+": executor is not a function - "+ct(e)),o(3,0));try{e.call(P,o(2,0),w)}catch(n){w(n)}return P}function a(e){return function(n){var t=C(arguments,1);return e(function(e,r){try{var u=[],o=1;En(n,function(n,t){n&&(o++,Mn(n,function(n){u[t]=n,0==--o&&e(u)},r))}),0==--o&&e(u)}catch(n){r(n)}},t)}}function l(e){return function(t){var n=C(arguments,1);return R(t)?t:e(function(n){n(t)},n)}}function y(t){return function(e){var n=C(arguments,1);return t(function(n,t){t(e)},n)}}var at,ft,lt,st=function(n){En(n,function(n){try{n()}catch(n){}})};function g(n,t){return it(g,(r=X(e=t)?e:0,function(n){_(function(){st(n)},r)}),n,t);var e,r}function p(n,t){var e=(at=at||O(tt)).v;if(!e)return g(n);j(n)||tn(tt+": executor is not a function - "+I(n));var r=0,e=new e(function(t,e){n(function(n){r=2,t(n)},function(n){r=3,e(n)})});return E(e,"state",{get:function(){return Zn[r]}}),e}function b(n){return it(b,st,n)}function P(n,t){var c,t=S(t)?ft:t;return it(P,(0<=t&&(c={timeout:+t}),function(t){var e,n,r=function(n){st(t)},u=c;function o(n){var t=Dn();return{didTimeout:n,timeRemaining:function(){return Gn-(n=t,Dn()-n);var n}}}(qn=qn||T(function(){return!!(n=requestIdleCallback)||n!==f;var n},!1)).v&&requestIdleCallback?(e=Ln(!0,function(n){return n&&cancelIdleCallback(n),requestIdleCallback(function(n){e.dn(),r(n||o(!1))},u)},function(n){cancelIdleCallback(n)})).h:_(function(){r(o(!0))},S(n=(u||{}).timeout)?Bn:n)}),n,t)}function w(n,t){return(lt=lt||u(function(){return p})).v.call(this,n,t)}wt("createAsyncAllPromise",a(g)),wt("createAsyncResolvedPromise",l(g)),wt("createAsyncRejectedPromise",y(g)),wt("createNativeAllPromise",a(p)),wt("createNativeResolvedPromise",l(p)),wt("createNativeRejectedPromise",y(p)),wt("createSyncAllPromise",a(b)),wt("createSyncResolvedPromise",l(b)),wt("createSyncRejectedPromise",y(b)),wt("createIdleAllPromise",a(P)),wt("createIdleResolvedPromise",l(P)),wt("createIdleRejectedPromise",y(P)),wt("createAllPromise",a(w)),wt("createResolvedPromise",l(w)),wt("createRejectedPromise",y(w));var vt,dt,x="reject",yt="Rejected",mt=0,ht={},gt=function(){},pt=function(n,t,e){function r(){this.constructor=o,Cn(this,u)}var u,o;ht[n]||(ht[n]=(a=(i=Error)[v][U],f=Error.captureStackTrace,l=i,Cn(o=function(){var n=this;try{_n(i,c);var t,e=d(i,n,C(arguments))||n;return e!==n&&(t=rn(n))!==rn(e)&&On(e,t),f&&f(e,n.constructor),e}finally{_n(i,a)}},u=c=n),(o=On(o,l))[v]=l===s?zn(l):(r[v]=l[v],new r),o));var c,i,a,f,l=m();return new ht[n]("Task [".concat(t.id,"] ").concat(e||"","- ").concat(t.st?"Running":"Waiting",": ").concat((l-(t.st||t.cr)||"0")+" ms"))};function bt(n,t){var e=m()-t;En(n,function(n){(n&&!n.rj&&n.st&&n.st<e||!n.st&&n.cr&&n.cr<e)&&n&&n[x](n.rj||pt("Aborted",n,"Stale "))})}function Pt(n,t){t=kn(n,t);-1!==t&&n.splice(t,1)}}}});
//# sourceMappingURL=ts-async.min.js.map

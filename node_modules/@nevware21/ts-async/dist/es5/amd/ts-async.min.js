/*!
 * NevWare21 - ts-async, 0.4.0
 * https://github.com/nevware21/ts-async
 * Copyright (c) NevWare21 and contributors. All rights reserved.
 * Licensed under the MIT license.
 */
define(["exports"],function(n){"use strict";var f=void 0,s=null,D="",q="function",F="object",v="prototype",H="__proto__",t="undefined",J="constructor",L="Symbol",U="length",W="name",$="slice",e=Object,B=e[v],G=String,r=Array,o=r[v];function K(t){return function(n){return typeof n===t}}function M(n){return B.toString.call(n)}function S(n){return typeof n===t||n===t}var j=K(q);function Q(n){return(n||n!==s&&!S(n))&&n&&typeof n===F}var V=r.isArray,X=K("number"),Y=function(n){return!(!n||"[object Error]"!==M(n))};function R(n){return n&&j(n.then)}var Z=e.getOwnPropertyDescriptor,nn=e.hasOwn||function(n,t){return n&&B.hasOwnProperty.call(n,t)||!!Z(n,t)};function u(n,t,e){if(n&&Q(n))for(var r in n)if(nn(n,r)&&-1===t.call(e||n,r,n[r]))break}function tn(n){throw new TypeError(n)}var en=e.freeze,r=en||function(n){return n},rn=e.getPrototypeOf||function(n){return n[H]||s},on={};u({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12},function(n,t){on[n]=n,on[t]=n});st=on,en&&u(st,function(n,t){(V(t)||Q(t))&&en(t)});var un,cn=r(st),an=G,fn="__tsUtils$gblCfg";function ln(){var n;return(n=(n=(n=typeof globalThis!==t?globalThis:n)||typeof self===t?n:self)||typeof window===t?n:window)||typeof global===t?n:global}function I(n,t){var e=D;if(Y(n))e="{ stack: '"+n.stack+"', message: '"+n.message+"', name: '"+n.name+"'";else try{e=JSON.stringify(n,s,t?X(t)?t:4:f)}catch(n){e=" - "+I(n,t)}return M(n)+": "+e}function sn(e,n){var r=n&&n[e];return function(n){var t=n&&n[e]||r;if(t)return t.apply(n,vn.call(arguments,1));t=n,tn("'"+an(e)+"' not defined for "+I(t))}}var A,vn=o[$],dn={},c={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"},E=e.defineProperty;function yn(n,t,e){var r,o;E(n,t,(r=e,(o={})[c.c]=!0,o[c.e]=!0,r.l&&(o.get=function(){return r.l.v},n=Z(r.l,"v"))&&n.set&&(o.set=function(n){r.l.v=n}),u(r,function(n,t){o[c[n]]=S(t)?o[c[n]]:t}),o))}var mn=function(){var n;un||(n=ln()||{},un=n[fn]=n[fn]||{}),A=un,mn=s};function hn(t){var e={};return mn&&mn(),e.b=A.lzy,E(e,"v",{configurable:!0,get:function(){var n=t();return A.lzy||(E(e,"v",{value:n}),e.b&&delete e.b),A.lzy&&e.b!==A.lzy&&(e.b=A.lzy),n}}),e}function T(e,r){return hn(function(){var n=e,t=r;try{t=n()}catch(n){}return t})}var i,a,pn,gn,k,bn,Pn,z=function(n){return T(function(){return Sn(n)||f},f)},wn=function(n){return(i=!i||!1===n||A&&A.lzy&&!i.b?T(ln,s):i).v},Sn=function(n,t){t=i&&!1!==t?i.v:wn(t);return t&&t[n]?t[n]:"window"===n&&a?a.v:s},jn=function(){return(a=!a||A&&A.lzy&&!a.b?z("window"):a).v},Rn=function(){return(gn=gn||T(function(){return!(!process||!(process.versions||{}).node)},!1)).v};function In(n){return T(function(){return k.v?k.v[n]:f},f)}function An(){var n=!k||A&&A.lzy&&!k.b;return n&&(k=z(L)),bn&&!n||(bn=In("for")),Pn&&!n||(Pn=In("keyFor")),k.v}var d=function(n){return n.apply.apply(n,vn.call(arguments,1))};function En(n,t,e){if(n)for(var r=n[U]>>>0,o=0;o<r&&!(o in n&&-1===t.call(e||n,n[o],o,n));o++);}var Tn,kn=sn("indexOf",o),O=(sn("lastIndexOf",o),sn($,o)),zn=e.create||function(n){if(!n)return{};var t=typeof n;if(t!==F&&t!=q)throw new TypeError("Prototype must be an Object or function: "+I(n));function e(){}return e[v]=n,new e};function On(n,t){return(e.setPrototypeOf||function(e,n){(Tn=Tn||hn(function(){var n={};return n[H]=[],n instanceof Array})).v?e[H]=n:u(n,function(n,t){return e[n]=t})})(n,t)}function Cn(n,t){try{t&&(n[W]=t)}catch(n){}}function _n(n,t){try{yn(n,W,{v:t,c:!0,e:!1})}catch(n){}}function h(){return(Date.now||Nn)()}function Nn(){return(new Date).getTime()}function p(n){return n[Dn]}var xn,Dn=U;function qn(){var n=(xn=!xn||!xn.b&&A&&A.lzy?z("performance"):xn).v;return n&&n.now?n.now():h()}var Fn,Hn="unref",Jn="hasRef",Ln="enabled";function Un(n,t,e){function r(){return i=!1,a&&a[Hn]&&a[Hn](),c}function o(){return a=t(a),i||r(),c}function u(){a&&e(a),a=s}var c,i=!0,a=n?t(s):s,n={cancel:u,refresh:o,hasRef:function(){return a&&a[Jn]?a[Jn]():i},ref:function(){return i=!0,a&&a.ref&&a.ref(),c}};return n[Hn]=r,n[Ln]=!1,E(c=n,Ln,{get:function(){return!!a},set:function(n){!n&&a&&u(),n&&!a&&o()}}),{h:c,dn:function(){a=s}}}function C(){return t=this,n=f,e=O(arguments),o=(r=V(n))?n.length:0,u=(0<o?n[0]:r?f:n)||setTimeout,c=(1<o?n[1]:f)||clearTimeout,i=e[0],e[0]=function(){a.dn(),d(i,t,O(arguments))},(a=Un(!0,function(n){if(n){if(n.refresh)return n.refresh(),n;d(c,t,[n])}return d(u,t,e)},function(n){d(c,t,[n])})).h;var t,n,e,r,o,u,c,i,a}var Wn,$n,Bn,Gn=100,Kn=50;function Mn(n,t){return Qn(n,function(n){return t?t({value:n,rejected:!1}):n},function(n){return t?t({rejected:!0,reason:n}):n})}function Qn(n,t,e,r){var o=n;return R(n)?(t||e)&&(o=n.then(t,e)):t&&(o=t(n)),r&&Vn(o,r),o}function Vn(n,t){var e=n;return t&&(R(n)?e=n.finally?n.finally(t):n.then(function(n){return t(),n},function(n){throw t(),n}):t()),e}var Xn,Yn,Zn=!1,nt=["pending","resolving","resolved","rejected"],tt="dispatchEvent",et="Promise",rt="unhandledRejection",ot=rt.toLowerCase(),_=[],ut=0,ct=10;function it(n){return j(n)?n.toString():I(n)}function at(n,t,e){function r(o,u){try{return _.push(h),g=!0,b&&b.cancel(),b=null,n(function(e,r){m.push(function(){try{var n=2===d?o:u,t=S(n)?a:j(n)?n(a):n;R(t)?t.then(e,r):(n||3!==d?e:r)(t)}catch(n){r(n)}}),y&&c()},v)}finally{_.pop()}}function o(){return nt[d]}function c(){var n;0<m.length&&(n=m.slice(),m=[],g=!0,t(n),b&&b.cancel(),b=null)}function u(t,e){return function(n){d===e&&(2===t&&R(n)?(d=1,n.then(u(2,1),u(3,1))):(d=t,y=!0,a=n,c(),g||3!==t||(b=b||C(i,ct))))}}function i(){var n,t,e,r,o;g||(Rn()?process.emit(rt,a,P):(e=jn()||wn(),n=ot,o=function(n){return yn(n,"promise",{g:function(){return P}}),n.reason=a,n},t=!!Yn.v,r=(pn=!pn||A&&A.lzy&&!pn.b?z("document"):pn).v,o(o=(Xn=Xn||T(function(){var n;return!!(n=r&&r.createEvent?r.createEvent("Event"):n)&&n.initEvent},null)).v?r.createEvent("Event"):t?new Event(n):{}),Xn.v&&o.initEvent(n,!1,!0),o&&e[tt]?e[tt](o):(t=e["on"+n])?t(o):(e=Sn("console"))&&(e.error||e.log)(n,I(o))))}var a,f,l,s,v=O(arguments,3),d=0,y=!1,m=[],h=ut++,p=0<_.length?_[_.length-1]:void 0,g=!1,b=null,P=(Yn=Yn||z(et+"RejectionEvent"),{then:r,catch:function(n){return r(void 0,n)},finally:function(t){var n=t,e=t;return j(t)&&(n=function(n){return t&&t(),n},e=function(n){throw t&&t(),n}),r(n,e)}}),w=(E(P,"state",{get:o}),Zn&&(f=function(){return M(a)},w=function(){return g},$n=$n||{toString:function(){return"[[PromiseResult]]"}},Bn=Bn||{toString:function(){return"[[PromiseIsHandled]]"}},E(s=P,Wn=Wn||{toString:function(){return"[[PromiseState]]"}},{get:o}),E(s,$n,{get:f}),E(s,Bn,{get:w})),An()&&(P[f=cn[11],k&&(!A.lzy||k.b)||An(),k.v?k.v[f||11]:(s=cn[11])?dn[s]=dn[s]||{description:an(l=L+"."+s),toString:function(){return L+"("+l+")"},_polyfill:!0}:void 0]="IPromise"),P.toString=function(){return"IPromise"+(Zn?"["+h+(S(p)?"":":"+p)+"]":"")+" "+o()+(y?" - "+it(a):"")},j(e)||tn(et+": executor is not a function - "+it(e)),u(3,0));try{e.call(P,u(2,0),w)}catch(n){w(n)}return P}function l(e){return function(n){var t=O(arguments,1);return e(function(e,r){try{var o=[],u=1;En(n,function(n,t){n&&(u++,Qn(n,function(n){o[t]=n,0==--u&&e(o)},r))}),0==--u&&e(o)}catch(n){r(n)}},t)}}function y(e){return function(t){var n=O(arguments,1);return R(t)?t:e(function(n){n(t)},n)}}function m(t){return function(e){var n=O(arguments,1);return t(function(n,t){t(e)},n)}}function ft(n){En(n,function(n){try{n()}catch(n){}})}function g(n,t){return at(g,(r=X(e=t)?e:0,function(n){C(function(){ft(n)},r)}),n,t);var e,r}var lt,r=l(g),st=y(g),G=m(g);function b(n,t){var e=(lt=lt||z(et)).v;if(!e)return g(n);j(n)||tn(et+": executor is not a function - "+I(n));var r=0,e=new e(function(t,e){n(function(n){r=2,t(n)},function(n){r=3,e(n)})});return E(e,"state",{get:function(){return nt[r]}}),e}var $=l(b),o=y(b),vt=m(b);function P(n){return at(P,ft,n)}var dt,yt=l(P),mt=y(P),ht=m(P);function w(n,t){var c,t=S(t)?dt:t;return at(w,(0<=t&&(c={timeout:+t}),function(t){var e,n,r=function(n){ft(t)},o=c;function u(n){var t=qn();return{didTimeout:n,timeRemaining:function(){return Kn-(n=t,qn()-n);var n}}}(Fn=Fn||T(function(){return!!(n=requestIdleCallback)||n!==f;var n},!1)).v&&requestIdleCallback?(e=Un(!0,function(n){return n&&cancelIdleCallback(n),requestIdleCallback(function(n){e.dn(),r(n||u(!1))},o)},function(n){cancelIdleCallback(n)})).h:C(function(){r(u(!0))},S(n=(o||{}).timeout)?Gn:n)}),n,t)}var pt,gt=l(w),bt=y(w),Pt=m(w);function N(n,t){return(pt=pt||hn(function(){return b})).v.call(this,n,t)}function wt(){}function St(n,t,e){function r(){this.constructor=u,_n(this,o)}var o,u;zt[n]||(zt[n]=(a=(i=Error)[v][W],f=Error.captureStackTrace,l=i,_n(u=function(){var n=this;try{Cn(i,c);var t,e=d(i,n,O(arguments))||n;return e!==n&&(t=rn(n))!==rn(e)&&On(e,t),f&&f(e,n[J]),e}finally{Cn(i,a)}},o=c=n),(u=On(u,l))[v]=l===s?zn(l):(r[v]=l[v],new r),u));var c,i,a,f,l=h();return new zt[n]("Task [".concat(t.id,"] ").concat(e||"","- ").concat(t.st?"Running":"Waiting",": ").concat((l-(t.st||t.cr)||"0")+" ms"))}var jt,Rt,It=l(N),At=y(N),Et=m(N),x="reject",Tt="Rejected",kt=0,zt={};function Ot(n,t){var e=h()-t;En(n,function(n){(n&&!n.rj&&n.st&&n.st<e||!n.st&&n.cr&&n.cr<e)&&n&&n[x](n.rj||St("Aborted",n,"Stale "))})}function Ct(n,t){t=kn(n,t);-1!==t&&n.splice(t,1)}n.createAllPromise=It,n.createAsyncAllPromise=r,n.createAsyncPromise=g,n.createAsyncRejectedPromise=G,n.createAsyncResolvedPromise=st,n.createIdleAllPromise=gt,n.createIdlePromise=w,n.createIdleRejectedPromise=Pt,n.createIdleResolvedPromise=bt,n.createNativeAllPromise=$,n.createNativePromise=b,n.createNativeRejectedPromise=vt,n.createNativeResolvedPromise=o,n.createPromise=N,n.createRejectedPromise=Et,n.createResolvedPromise=At,n.createSyncAllPromise=yt,n.createSyncPromise=P,n.createSyncRejectedPromise=ht,n.createSyncResolvedPromise=mt,n.createTaskScheduler=function(a,n){function f(){var n=0<p(v)+p(d);0<e&&(o||(o=C(function(){Ot(v,e),Ot(d,e),o&&(o.enabled=0<p(v)+p(d))},r)).unref(),o)&&(o.enabled=n)}function l(u,c){return u.st=h(),v.push(u),f(),function(t,e){function r(n){u.rj=u.rj||n||St(Tt,u),u[x]=wt,i(u),t=null,e&&e(n),e=null}var n=u.id;if(u.rj)r(u.rj);else{u[x]=r;try{var o=c(n);u.to&&R(o)&&(u.t=C(function(){r(St("Timeout",u))},u.to)),Qn(o,function(n){i(u),e=null,t&&t(n),t=null},r)}catch(n){r(n)}}}}function i(n){Ct(v,n),n.t&&n.t.cancel(),n.t=null,s&&s===n&&(s=null,p(v)+p(d)===0)&&(o&&o.cancel(),o=null)}var s,e,r,o,t,u,v=[],d=[],y=0,m=(n?n+".":"")+kt++,n=(a=a||N,{idle:!0,queue:function(n,t,e){var r,o,u,c=m+"."+y++,i=(t&&(c+="-("+t+")"),(t={id:c,cr:h(),to:e})[x]=function(n){i.rj=n||St(Tt,i),i[x]=wt},t);return i.p=s?(o=s,u=n,d.push(r=i),f(),a(function(n,t){r.id,o.id,Mn(o.p,function(){Ct(d,r),l(r,u)(n,t)})})):a(l(i,n)),(s=i).p},setStaleTimeout:function(n,t){o&&o.cancel(),o=null,e=n,r=t||n/10,f()}});return yn(n,"idle",{g:function(){return p(v)+p(d)===0}}),u=function(){return{l:s,r:v,w:d}},Rt=Rt||{toString:function(){return"[[SchedulerState]]"}},E(t=n,jt=jt||{toString:function(){return"[[SchedulerName]]"}},{get:function(){return m}}),E(t,Rt,{get:u}),n},n.doAwait=Qn,n.doAwaitResponse=Mn,n.doFinally=Vn,n.setCreatePromiseImpl=function(n){pt=n?hn(function(){return n}):null},n.setDetaultIdleTimeout=function(n){dt=n},n.setPromiseDebugState=function(n,t){Zn=n}});
//# sourceMappingURL=ts-async.min.js.map
